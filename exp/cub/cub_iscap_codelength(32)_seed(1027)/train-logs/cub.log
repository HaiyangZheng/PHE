2024-12-08 23:46:14,349 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=32, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='cub', output_dir='exp//cub/cub_iscap_codelength(32)_seed(1027)', device='cuda', seed=1027, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
2024-12-08 23:46:18,588 - main - INFO - train 1498 test: 2884
2024-12-08 23:46:18,588 - main - INFO - test_dataset_unlabelled: 4496
2024-12-08 23:46:20,883 - main - INFO - number of params: 14751040
2024-12-08 23:46:20,884 - main - INFO - Start training for 200 epochs
2024-12-08 23:46:20,884 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:46:39,564 - log_every - INFO - Epoch: [0]  [ 0/12]  eta: 0:03:44  lr: 0.000100  loss_protop: 5.0339 (5.0339)  loss_feature: 4.6131 (4.6131)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.6035 (0.6035)  time: 18.6758  data: 12.3045  max mem: 3428
2024-12-08 23:46:40,804 - log_every - INFO - Epoch: [0]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8962 (4.9015)  loss_feature: 4.2949 (4.3542)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5366 (0.5451)  time: 1.6595  data: 1.0254  max mem: 3597
2024-12-08 23:46:40,979 - log_every - INFO - Epoch: [0] Total time: 0:00:20 (1.6746 s / it)
2024-12-08 23:46:40,982 - evaluate - INFO - Start validation
2024-12-08 23:46:40,982 - evaluate - INFO - Radius: 5
2024-12-08 23:47:22,911 - evaluate - INFO - test len(list(set(preds1))): 618 len(preds): 4496
2024-12-08 23:47:22,911 - evaluate - INFO - Evaluate V1: all_acc: 0.185 old_acc: 0.213 new_acc: 0.171
2024-12-08 23:47:22,926 - evaluate - INFO - Evaluate V2: all_acc: 0.156 old_acc: 0.139 new_acc: 0.165
2024-12-08 23:47:22,928 - main - INFO - Averaged stats:
2024-12-08 23:47:22,928 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.901470065116882, 'loss_feature': 4.354222377141316, 'loss_sep': 0.0, 'loss_quan': 0.5450642903645834}
2024-12-08 23:47:22,929 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:47:32,966 - log_every - INFO - Epoch: [1]  [ 0/12]  eta: 0:02:00  lr: 0.000100  loss_protop: 4.9019 (4.9019)  loss_feature: 3.9740 (3.9740)  loss_sep: 0.0141 (0.0141)  loss_quan: 0.4746 (0.4746)  time: 10.0372  data: 9.8390  max mem: 3597
2024-12-08 23:47:34,956 - log_every - INFO - Epoch: [1]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9284 (4.9426)  loss_feature: 3.9118 (3.9130)  loss_sep: 0.0658 (0.0666)  loss_quan: 0.4395 (0.4460)  time: 1.0021  data: 0.8543  max mem: 3597
2024-12-08 23:47:35,308 - log_every - INFO - Epoch: [1] Total time: 0:00:12 (1.0316 s / it)
2024-12-08 23:47:35,309 - evaluate - INFO - Start validation
2024-12-08 23:47:35,309 - evaluate - INFO - Radius: 5
2024-12-08 23:48:14,527 - evaluate - INFO - test len(list(set(preds1))): 587 len(preds): 4496
2024-12-08 23:48:14,527 - evaluate - INFO - Evaluate V1: all_acc: 0.209 old_acc: 0.252 new_acc: 0.188
2024-12-08 23:48:14,540 - evaluate - INFO - Evaluate V2: all_acc: 0.183 old_acc: 0.193 new_acc: 0.178
2024-12-08 23:48:14,542 - main - INFO - Averaged stats:
2024-12-08 23:48:14,542 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.942580143610637, 'loss_feature': 3.9129520257314048, 'loss_sep': 0.06657551896447937, 'loss_quan': 0.446044921875}
2024-12-08 23:48:14,543 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:48:24,543 - log_every - INFO - Epoch: [2]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.9753 (4.9753)  loss_feature: 3.8320 (3.8320)  loss_sep: 0.0166 (0.0166)  loss_quan: 0.4304 (0.4304)  time: 9.9990  data: 9.7991  max mem: 3597
2024-12-08 23:48:26,615 - log_every - INFO - Epoch: [2]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8870 (4.9226)  loss_feature: 3.8038 (3.8059)  loss_sep: 0.0162 (0.0282)  loss_quan: 0.4260 (0.4251)  time: 1.0059  data: 0.8554  max mem: 3597
2024-12-08 23:48:26,986 - log_every - INFO - Epoch: [2] Total time: 0:00:12 (1.0369 s / it)
2024-12-08 23:48:26,987 - evaluate - INFO - Start validation
2024-12-08 23:48:26,987 - evaluate - INFO - Radius: 5
2024-12-08 23:49:06,160 - evaluate - INFO - test len(list(set(preds1))): 522 len(preds): 4496
2024-12-08 23:49:06,160 - evaluate - INFO - Evaluate V1: all_acc: 0.259 old_acc: 0.303 new_acc: 0.238
2024-12-08 23:49:06,173 - evaluate - INFO - Evaluate V2: all_acc: 0.235 old_acc: 0.248 new_acc: 0.228
2024-12-08 23:49:06,175 - main - INFO - Averaged stats:
2024-12-08 23:49:06,175 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.922638813654582, 'loss_feature': 3.8058584133783975, 'loss_sep': 0.028164062028129894, 'loss_quan': 0.4251302083333333}
2024-12-08 23:49:06,176 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:49:16,088 - log_every - INFO - Epoch: [3]  [ 0/12]  eta: 0:01:58  lr: 0.000100  loss_protop: 4.8640 (4.8640)  loss_feature: 3.7666 (3.7666)  loss_sep: 0.0216 (0.0216)  loss_quan: 0.4175 (0.4175)  time: 9.9113  data: 9.6859  max mem: 3597
2024-12-08 23:49:18,316 - log_every - INFO - Epoch: [3]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8741 (4.9080)  loss_feature: 3.7556 (3.7565)  loss_sep: 0.0216 (0.0214)  loss_quan: 0.4121 (0.4124)  time: 1.0116  data: 0.8631  max mem: 3597
2024-12-08 23:49:18,696 - log_every - INFO - Epoch: [3] Total time: 0:00:12 (1.0433 s / it)
2024-12-08 23:49:18,697 - evaluate - INFO - Start validation
2024-12-08 23:49:18,697 - evaluate - INFO - Radius: 5
2024-12-08 23:49:58,070 - evaluate - INFO - test len(list(set(preds1))): 539 len(preds): 4496
2024-12-08 23:49:58,070 - evaluate - INFO - Evaluate V1: all_acc: 0.270 old_acc: 0.334 new_acc: 0.239
2024-12-08 23:49:58,083 - evaluate - INFO - Evaluate V2: all_acc: 0.241 old_acc: 0.269 new_acc: 0.227
2024-12-08 23:49:58,085 - main - INFO - Averaged stats:
2024-12-08 23:49:58,085 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.907962361971538, 'loss_feature': 3.7565295696258545, 'loss_sep': 0.02136718714609742, 'loss_quan': 0.412353515625}
2024-12-08 23:49:58,086 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:50:08,074 - log_every - INFO - Epoch: [4]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.8628 (4.8628)  loss_feature: 3.7259 (3.7259)  loss_sep: 0.0206 (0.0206)  loss_quan: 0.4070 (0.4070)  time: 9.9877  data: 9.8292  max mem: 3597
2024-12-08 23:50:10,184 - log_every - INFO - Epoch: [4]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8598 (4.8695)  loss_feature: 3.7309 (3.7287)  loss_sep: 0.0077 (0.0134)  loss_quan: 0.4067 (0.4063)  time: 1.0080  data: 0.8591  max mem: 3597
2024-12-08 23:50:10,560 - log_every - INFO - Epoch: [4] Total time: 0:00:12 (1.0395 s / it)
2024-12-08 23:50:10,561 - evaluate - INFO - Start validation
2024-12-08 23:50:10,561 - evaluate - INFO - Radius: 5
2024-12-08 23:50:50,162 - evaluate - INFO - test len(list(set(preds1))): 567 len(preds): 4496
2024-12-08 23:50:50,162 - evaluate - INFO - Evaluate V1: all_acc: 0.283 old_acc: 0.342 new_acc: 0.253
2024-12-08 23:50:50,176 - evaluate - INFO - Evaluate V2: all_acc: 0.256 old_acc: 0.294 new_acc: 0.238
2024-12-08 23:50:50,178 - main - INFO - Averaged stats:
2024-12-08 23:50:50,178 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.869468808174133, 'loss_feature': 3.728735605875651, 'loss_sep': 0.013372395439849546, 'loss_quan': 0.40631103515625}
2024-12-08 23:50:50,179 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:50:59,919 - log_every - INFO - Epoch: [5]  [ 0/12]  eta: 0:01:56  lr: 0.000100  loss_protop: 4.8361 (4.8361)  loss_feature: 3.7087 (3.7087)  loss_sep: 0.0094 (0.0094)  loss_quan: 0.4075 (0.4075)  time: 9.7399  data: 9.4402  max mem: 3597
2024-12-08 23:51:02,341 - log_every - INFO - Epoch: [5]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.7853 (4.7863)  loss_feature: 3.7102 (3.7112)  loss_sep: 0.0094 (0.0097)  loss_quan: 0.4014 (0.4025)  time: 1.0134  data: 0.8502  max mem: 3597
2024-12-08 23:51:02,728 - log_every - INFO - Epoch: [5] Total time: 0:00:12 (1.0457 s / it)
2024-12-08 23:51:02,728 - evaluate - INFO - Start validation
2024-12-08 23:51:02,728 - evaluate - INFO - Radius: 5
2024-12-08 23:51:42,325 - evaluate - INFO - test len(list(set(preds1))): 596 len(preds): 4496
2024-12-08 23:51:42,325 - evaluate - INFO - Evaluate V1: all_acc: 0.298 old_acc: 0.368 new_acc: 0.262
2024-12-08 23:51:42,340 - evaluate - INFO - Evaluate V2: all_acc: 0.264 old_acc: 0.288 new_acc: 0.252
2024-12-08 23:51:42,342 - main - INFO - Averaged stats:
2024-12-08 23:51:42,342 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.786336421966553, 'loss_feature': 3.711196541786194, 'loss_sep': 0.009739583008922637, 'loss_quan': 0.4024658203125}
2024-12-08 23:51:42,343 - train_and_evaluate - INFO - Start train one epoch

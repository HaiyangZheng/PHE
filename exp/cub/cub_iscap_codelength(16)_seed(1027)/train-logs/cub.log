2024-12-08 23:46:14,376 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=16, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='cub', output_dir='exp//cub/cub_iscap_codelength(16)_seed(1027)', device='cuda', seed=1027, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
2024-12-08 23:46:18,806 - main - INFO - train 1498 test: 2884
2024-12-08 23:46:18,806 - main - INFO - test_dataset_unlabelled: 4496
2024-12-08 23:46:22,307 - main - INFO - number of params: 14746912
2024-12-08 23:46:22,308 - main - INFO - Start training for 200 epochs
2024-12-08 23:46:22,309 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:46:41,775 - log_every - INFO - Epoch: [0]  [ 0/12]  eta: 0:03:53  lr: 0.000100  loss_protop: 4.8815 (4.8815)  loss_feature: 4.6320 (4.6320)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5864 (0.5864)  time: 19.4622  data: 13.5474  max mem: 3428
2024-12-08 23:46:43,013 - log_every - INFO - Epoch: [0]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9252 (4.9325)  loss_feature: 4.2991 (4.3363)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5015 (0.5118)  time: 1.7249  data: 1.1290  max mem: 3597
2024-12-08 23:46:43,223 - log_every - INFO - Epoch: [0] Total time: 0:00:20 (1.7429 s / it)
2024-12-08 23:46:43,227 - evaluate - INFO - Start validation
2024-12-08 23:46:43,227 - evaluate - INFO - Radius: 2
2024-12-08 23:47:20,542 - evaluate - INFO - test len(list(set(preds1))): 290 len(preds): 4496
2024-12-08 23:47:20,542 - evaluate - INFO - Evaluate V1: all_acc: 0.175 old_acc: 0.199 new_acc: 0.163
2024-12-08 23:47:20,550 - evaluate - INFO - Evaluate V2: all_acc: 0.145 old_acc: 0.127 new_acc: 0.153
2024-12-08 23:47:20,551 - main - INFO - Averaged stats:
2024-12-08 23:47:20,551 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.9325162172317505, 'loss_feature': 4.336271365483602, 'loss_sep': 0.0, 'loss_quan': 0.5117594401041666}
2024-12-08 23:47:20,552 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:47:30,536 - log_every - INFO - Epoch: [1]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.9725 (4.9725)  loss_feature: 3.9544 (3.9544)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.4238 (0.4238)  time: 9.9833  data: 9.7625  max mem: 3597
2024-12-08 23:47:32,793 - log_every - INFO - Epoch: [1]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9329 (4.9184)  loss_feature: 3.9000 (3.9052)  loss_sep: 0.0000 (0.0056)  loss_quan: 0.3914 (0.3963)  time: 1.0200  data: 0.8712  max mem: 3597
2024-12-08 23:47:33,240 - log_every - INFO - Epoch: [1] Total time: 0:00:12 (1.0574 s / it)
2024-12-08 23:47:33,241 - evaluate - INFO - Start validation
2024-12-08 23:47:33,241 - evaluate - INFO - Radius: 2
2024-12-08 23:48:10,600 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 4496
2024-12-08 23:48:10,600 - evaluate - INFO - Evaluate V1: all_acc: 0.204 old_acc: 0.241 new_acc: 0.185
2024-12-08 23:48:10,609 - evaluate - INFO - Evaluate V2: all_acc: 0.170 old_acc: 0.160 new_acc: 0.175
2024-12-08 23:48:10,610 - main - INFO - Averaged stats:
2024-12-08 23:48:10,610 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.918416500091553, 'loss_feature': 3.9051726261774697, 'loss_sep': 0.0056087239645421505, 'loss_quan': 0.3963216145833333}
2024-12-08 23:48:10,611 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:48:20,532 - log_every - INFO - Epoch: [2]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.9583 (4.9583)  loss_feature: 3.8163 (3.8163)  loss_sep: 0.0153 (0.0153)  loss_quan: 0.3779 (0.3779)  time: 9.9206  data: 9.7062  max mem: 3597
2024-12-08 23:48:22,857 - log_every - INFO - Epoch: [2]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9313 (4.9315)  loss_feature: 3.8022 (3.8021)  loss_sep: 0.0109 (0.0122)  loss_quan: 0.3601 (0.3622)  time: 1.0204  data: 0.8725  max mem: 3597
2024-12-08 23:48:23,293 - log_every - INFO - Epoch: [2] Total time: 0:00:12 (1.0568 s / it)
2024-12-08 23:48:23,293 - evaluate - INFO - Start validation
2024-12-08 23:48:23,294 - evaluate - INFO - Radius: 2
2024-12-08 23:49:00,531 - evaluate - INFO - test len(list(set(preds1))): 320 len(preds): 4496
2024-12-08 23:49:00,531 - evaluate - INFO - Evaluate V1: all_acc: 0.242 old_acc: 0.286 new_acc: 0.221
2024-12-08 23:49:00,539 - evaluate - INFO - Evaluate V2: all_acc: 0.198 old_acc: 0.187 new_acc: 0.203
2024-12-08 23:49:00,541 - main - INFO - Averaged stats:
2024-12-08 23:49:00,541 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.9315182367960615, 'loss_feature': 3.8021169304847717, 'loss_sep': 0.012171223759651184, 'loss_quan': 0.36224365234375}
2024-12-08 23:49:00,542 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:49:10,614 - log_every - INFO - Epoch: [3]  [ 0/12]  eta: 0:02:00  lr: 0.000100  loss_protop: 4.7875 (4.7875)  loss_feature: 3.7559 (3.7559)  loss_sep: 0.0073 (0.0073)  loss_quan: 0.3440 (0.3440)  time: 10.0716  data: 9.9084  max mem: 3597
2024-12-08 23:49:12,765 - log_every - INFO - Epoch: [3]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8380 (4.8557)  loss_feature: 3.7547 (3.7559)  loss_sep: 0.0073 (0.0091)  loss_quan: 0.3320 (0.3340)  time: 1.0185  data: 0.8696  max mem: 3597
2024-12-08 23:49:13,205 - log_every - INFO - Epoch: [3] Total time: 0:00:12 (1.0552 s / it)
2024-12-08 23:49:13,205 - evaluate - INFO - Start validation
2024-12-08 23:49:13,205 - evaluate - INFO - Radius: 2
2024-12-08 23:49:50,421 - evaluate - INFO - test len(list(set(preds1))): 307 len(preds): 4496
2024-12-08 23:49:50,422 - evaluate - INFO - Evaluate V1: all_acc: 0.254 old_acc: 0.305 new_acc: 0.228
2024-12-08 23:49:50,429 - evaluate - INFO - Evaluate V2: all_acc: 0.215 old_acc: 0.214 new_acc: 0.216
2024-12-08 23:49:50,431 - main - INFO - Averaged stats:
2024-12-08 23:49:50,431 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.8557166655858355, 'loss_feature': 3.7559476296106973, 'loss_sep': 0.009104817659438899, 'loss_quan': 0.3340250651041667}
2024-12-08 23:49:50,432 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:50:00,201 - log_every - INFO - Epoch: [4]  [ 0/12]  eta: 0:01:57  lr: 0.000100  loss_protop: 4.9379 (4.9379)  loss_feature: 3.7271 (3.7271)  loss_sep: 0.0025 (0.0025)  loss_quan: 0.3286 (0.3286)  time: 9.7684  data: 9.4820  max mem: 3597
2024-12-08 23:50:02,627 - log_every - INFO - Epoch: [4]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8865 (4.8805)  loss_feature: 3.7289 (3.7308)  loss_sep: 0.0093 (0.0087)  loss_quan: 0.3228 (0.3242)  time: 1.0162  data: 0.8589  max mem: 3597
2024-12-08 23:50:03,088 - log_every - INFO - Epoch: [4] Total time: 0:00:12 (1.0547 s / it)
2024-12-08 23:50:03,088 - evaluate - INFO - Start validation
2024-12-08 23:50:03,089 - evaluate - INFO - Radius: 2
2024-12-08 23:50:40,265 - evaluate - INFO - test len(list(set(preds1))): 308 len(preds): 4496
2024-12-08 23:50:40,265 - evaluate - INFO - Evaluate V1: all_acc: 0.276 old_acc: 0.342 new_acc: 0.243
2024-12-08 23:50:40,272 - evaluate - INFO - Evaluate V2: all_acc: 0.224 old_acc: 0.235 new_acc: 0.218
2024-12-08 23:50:40,274 - main - INFO - Averaged stats:
2024-12-08 23:50:40,274 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.880489985148112, 'loss_feature': 3.730803966522217, 'loss_sep': 0.008675130064754436, 'loss_quan': 0.3241984049479167}
2024-12-08 23:50:40,274 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:50:50,306 - log_every - INFO - Epoch: [5]  [ 0/12]  eta: 0:02:00  lr: 0.000100  loss_protop: 4.7084 (4.7084)  loss_feature: 3.7152 (3.7152)  loss_sep: 0.0097 (0.0097)  loss_quan: 0.3203 (0.3203)  time: 10.0312  data: 9.8521  max mem: 3597
2024-12-08 23:50:52,525 - log_every - INFO - Epoch: [5]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.7795 (4.7961)  loss_feature: 3.7141 (3.7142)  loss_sep: 0.0073 (0.0074)  loss_quan: 0.3169 (0.3174)  time: 1.0207  data: 0.8720  max mem: 3597
2024-12-08 23:50:52,989 - log_every - INFO - Epoch: [5] Total time: 0:00:12 (1.0596 s / it)
2024-12-08 23:50:52,990 - evaluate - INFO - Start validation
2024-12-08 23:50:52,990 - evaluate - INFO - Radius: 2
2024-12-08 23:51:30,260 - evaluate - INFO - test len(list(set(preds1))): 323 len(preds): 4496
2024-12-08 23:51:30,260 - evaluate - INFO - Evaluate V1: all_acc: 0.264 old_acc: 0.341 new_acc: 0.226
2024-12-08 23:51:30,269 - evaluate - INFO - Evaluate V2: all_acc: 0.222 old_acc: 0.247 new_acc: 0.210
2024-12-08 23:51:30,270 - main - INFO - Averaged stats:
2024-12-08 23:51:30,270 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.796120723088582, 'loss_feature': 3.714197337627411, 'loss_sep': 0.007369791564997286, 'loss_quan': 0.3174031575520833}
2024-12-08 23:51:30,271 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:51:40,358 - log_every - INFO - Epoch: [6]  [ 0/12]  eta: 0:02:01  lr: 0.000100  loss_protop: 4.8605 (4.8605)  loss_feature: 3.6982 (3.6982)  loss_sep: 0.0090 (0.0090)  loss_quan: 0.3147 (0.3147)  time: 10.0869  data: 9.9245  max mem: 3597
2024-12-08 23:51:42,481 - log_every - INFO - Epoch: [6]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8196 (4.8115)  loss_feature: 3.7046 (3.7043)  loss_sep: 0.0069 (0.0073)  loss_quan: 0.3052 (0.3073)  time: 1.0174  data: 0.8762  max mem: 3597
2024-12-08 23:51:42,899 - log_every - INFO - Epoch: [6] Total time: 0:00:12 (1.0523 s / it)
2024-12-08 23:51:42,900 - evaluate - INFO - Start validation
2024-12-08 23:51:42,900 - evaluate - INFO - Radius: 2

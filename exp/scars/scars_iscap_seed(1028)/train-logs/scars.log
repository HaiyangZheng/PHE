2024-12-08 23:13:11,438 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=12, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='scars', output_dir='exp//scars/scars_iscap_seed(1028)', device='cuda', seed=1028, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/stanford_cars', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
2024-12-08 23:13:11,854 - main - INFO - train 2000 test: 3948
2024-12-08 23:13:11,854 - main - INFO - test_dataset_unlabelled: 6144
2024-12-08 23:13:15,584 - main - INFO - number of params: 14730520
2024-12-08 23:13:15,585 - main - INFO - Start training for 200 epochs
2024-12-08 23:13:15,586 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:13:47,645 - log_every - INFO - Epoch: [0]  [ 0/16]  eta: 0:08:32  lr: 0.000100  loss_protop: 4.8885 (4.8885)  loss_feature: 4.6756 (4.6756)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5996 (0.5996)  time: 32.0555  data: 20.4547  max mem: 3395
2024-12-08 23:13:49,314 - log_every - INFO - Epoch: [0]  [15/16]  eta: 0:00:02  lr: 0.000100  loss_protop: 4.8894 (4.9258)  loss_feature: 4.3377 (4.3907)  loss_sep: 0.0000 (0.0189)  loss_quan: 0.4312 (0.4618)  time: 2.1077  data: 1.2785  max mem: 3567
2024-12-08 23:13:49,538 - log_every - INFO - Epoch: [0] Total time: 0:00:33 (2.1220 s / it)
2024-12-08 23:13:49,541 - evaluate - INFO - Start validation
2024-12-08 23:13:49,541 - evaluate - INFO - Radius: 1
2024-12-08 23:15:03,646 - evaluate - INFO - Evaluate V1: all_acc: 0.111 old_acc: 0.133 new_acc: 0.100
2024-12-08 23:15:03,653 - evaluate - INFO - Evaluate V2: all_acc: 0.088 old_acc: 0.071 new_acc: 0.095
2024-12-08 23:15:03,655 - main - INFO - Averaged stats:
2024-12-08 23:15:03,655 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.925754874944687, 'loss_feature': 4.390737354755402, 'loss_sep': 0.01889100344851613, 'loss_quan': 0.4617919921875}
2024-12-08 23:15:03,655 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:15:22,180 - log_every - INFO - Epoch: [1]  [ 0/16]  eta: 0:04:56  lr: 0.000100  loss_protop: 5.0241 (5.0241)  loss_feature: 4.0809 (4.0809)  loss_sep: 0.0625 (0.0625)  loss_quan: 0.3638 (0.3638)  time: 18.5242  data: 18.2966  max mem: 3567
2024-12-08 23:15:29,804 - log_every - INFO - Epoch: [1]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9293 (4.9208)  loss_feature: 4.0191 (4.0276)  loss_sep: 0.0625 (0.0651)  loss_quan: 0.3467 (0.3475)  time: 1.6342  data: 1.4659  max mem: 3567
2024-12-08 23:15:30,194 - log_every - INFO - Epoch: [1] Total time: 0:00:26 (1.6587 s / it)
2024-12-08 23:15:30,195 - evaluate - INFO - Start validation
2024-12-08 23:15:30,195 - evaluate - INFO - Radius: 1
2024-12-08 23:16:42,642 - evaluate - INFO - Evaluate V1: all_acc: 0.135 old_acc: 0.157 new_acc: 0.124
2024-12-08 23:16:42,649 - evaluate - INFO - Evaluate V2: all_acc: 0.104 old_acc: 0.075 new_acc: 0.118
2024-12-08 23:16:42,650 - main - INFO - Averaged stats:
2024-12-08 23:16:42,650 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.920845717191696, 'loss_feature': 4.02757816016674, 'loss_sep': 0.0651008440181613, 'loss_quan': 0.3475341796875}
2024-12-08 23:16:42,651 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:16:59,887 - log_every - INFO - Epoch: [2]  [ 0/16]  eta: 0:04:35  lr: 0.000100  loss_protop: 4.7837 (4.7837)  loss_feature: 3.9469 (3.9469)  loss_sep: 0.0562 (0.0562)  loss_quan: 0.3350 (0.3350)  time: 17.2355  data: 17.0100  max mem: 3567
2024-12-08 23:17:08,701 - log_every - INFO - Epoch: [2]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8187 (4.8392)  loss_feature: 3.9078 (3.9137)  loss_sep: 0.0322 (0.0487)  loss_quan: 0.3381 (0.3382)  time: 1.6280  data: 1.4583  max mem: 3567
2024-12-08 23:17:09,091 - log_every - INFO - Epoch: [2] Total time: 0:00:26 (1.6525 s / it)
2024-12-08 23:17:09,092 - evaluate - INFO - Start validation
2024-12-08 23:17:09,092 - evaluate - INFO - Radius: 1
2024-12-08 23:18:22,302 - evaluate - INFO - Evaluate V1: all_acc: 0.147 old_acc: 0.181 new_acc: 0.130
2024-12-08 23:18:22,310 - evaluate - INFO - Evaluate V2: all_acc: 0.112 old_acc: 0.090 new_acc: 0.123
2024-12-08 23:18:22,311 - main - INFO - Averaged stats:
2024-12-08 23:18:22,311 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.839176416397095, 'loss_feature': 3.91370353102684, 'loss_sep': 0.048686124151572585, 'loss_quan': 0.338226318359375}
2024-12-08 23:18:22,312 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:18:39,425 - log_every - INFO - Epoch: [3]  [ 0/16]  eta: 0:04:33  lr: 0.000100  loss_protop: 4.9801 (4.9801)  loss_feature: 3.8477 (3.8477)  loss_sep: 0.0450 (0.0450)  loss_quan: 0.3347 (0.3347)  time: 17.1129  data: 16.9013  max mem: 3567
2024-12-08 23:18:48,345 - log_every - INFO - Epoch: [3]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8715 (4.8887)  loss_feature: 3.8534 (3.8539)  loss_sep: 0.0379 (0.0404)  loss_quan: 0.3296 (0.3297)  time: 1.6270  data: 1.4610  max mem: 3567
2024-12-08 23:18:48,733 - log_every - INFO - Epoch: [3] Total time: 0:00:26 (1.6514 s / it)
2024-12-08 23:18:48,734 - evaluate - INFO - Start validation
2024-12-08 23:18:48,734 - evaluate - INFO - Radius: 1
2024-12-08 23:20:01,820 - evaluate - INFO - Evaluate V1: all_acc: 0.147 old_acc: 0.175 new_acc: 0.134
2024-12-08 23:20:01,828 - evaluate - INFO - Evaluate V2: all_acc: 0.115 old_acc: 0.089 new_acc: 0.127
2024-12-08 23:20:01,829 - main - INFO - Averaged stats:
2024-12-08 23:20:01,829 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.888721019029617, 'loss_feature': 3.8538784086704254, 'loss_sep': 0.04035544767975807, 'loss_quan': 0.3296966552734375}
2024-12-08 23:20:01,830 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:20:20,760 - log_every - INFO - Epoch: [4]  [ 0/16]  eta: 0:05:02  lr: 0.000100  loss_protop: 4.9116 (4.9116)  loss_feature: 3.8137 (3.8137)  loss_sep: 0.0345 (0.0345)  loss_quan: 0.3311 (0.3311)  time: 18.9291  data: 18.7398  max mem: 3567
2024-12-08 23:20:28,028 - log_every - INFO - Epoch: [4]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8419 (4.8641)  loss_feature: 3.8097 (3.8131)  loss_sep: 0.0273 (0.0270)  loss_quan: 0.3325 (0.3326)  time: 1.6373  data: 1.4811  max mem: 3567
2024-12-08 23:20:28,418 - log_every - INFO - Epoch: [4] Total time: 0:00:26 (1.6618 s / it)
2024-12-08 23:20:28,419 - evaluate - INFO - Start validation
2024-12-08 23:20:28,419 - evaluate - INFO - Radius: 1
2024-12-08 23:21:41,681 - evaluate - INFO - Evaluate V1: all_acc: 0.165 old_acc: 0.209 new_acc: 0.144
2024-12-08 23:21:41,689 - evaluate - INFO - Evaluate V2: all_acc: 0.130 old_acc: 0.131 new_acc: 0.130
2024-12-08 23:21:41,690 - main - INFO - Averaged stats:
2024-12-08 23:21:41,690 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.8640857338905334, 'loss_feature': 3.8131370544433594, 'loss_sep': 0.0269875037483871, 'loss_quan': 0.3326416015625}
2024-12-08 23:21:41,691 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:21:57,563 - log_every - INFO - Epoch: [5]  [ 0/16]  eta: 0:04:13  lr: 0.000100  loss_protop: 4.9286 (4.9286)  loss_feature: 3.7923 (3.7923)  loss_sep: 0.0269 (0.0269)  loss_quan: 0.3267 (0.3267)  time: 15.8714  data: 15.6188  max mem: 3567
2024-12-08 23:22:07,884 - log_every - INFO - Epoch: [5]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8347 (4.8429)  loss_feature: 3.7850 (3.7869)  loss_sep: 0.0211 (0.0224)  loss_quan: 0.3267 (0.3273)  time: 1.6370  data: 1.4726  max mem: 3567
2024-12-08 23:22:08,274 - log_every - INFO - Epoch: [5] Total time: 0:00:26 (1.6614 s / it)
2024-12-08 23:22:08,275 - evaluate - INFO - Start validation
2024-12-08 23:22:08,275 - evaluate - INFO - Radius: 1
2024-12-08 23:23:21,080 - evaluate - INFO - Evaluate V1: all_acc: 0.183 old_acc: 0.226 new_acc: 0.162
2024-12-08 23:23:21,088 - evaluate - INFO - Evaluate V2: all_acc: 0.142 old_acc: 0.128 new_acc: 0.148
2024-12-08 23:23:21,089 - main - INFO - Averaged stats:
2024-12-08 23:23:21,089 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.842943072319031, 'loss_feature': 3.786911576986313, 'loss_sep': 0.022366270306520164, 'loss_quan': 0.3273468017578125}
2024-12-08 23:23:21,090 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:23:38,551 - log_every - INFO - Epoch: [6]  [ 0/16]  eta: 0:04:39  lr: 0.000100  loss_protop: 4.8010 (4.8010)  loss_feature: 3.7645 (3.7645)  loss_sep: 0.0240 (0.0240)  loss_quan: 0.3320 (0.3320)  time: 17.4607  data: 17.2329  max mem: 3567
2024-12-08 23:23:47,365 - log_every - INFO - Epoch: [6]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8004 (4.8022)  loss_feature: 3.7638 (3.7642)  loss_sep: 0.0188 (0.0226)  loss_quan: 0.3328 (0.3339)  time: 1.6421  data: 1.4783  max mem: 3567
2024-12-08 23:23:47,755 - log_every - INFO - Epoch: [6] Total time: 0:00:26 (1.6666 s / it)
2024-12-08 23:23:47,755 - evaluate - INFO - Start validation
2024-12-08 23:23:47,755 - evaluate - INFO - Radius: 1
2024-12-08 23:25:00,606 - evaluate - INFO - Evaluate V1: all_acc: 0.179 old_acc: 0.240 new_acc: 0.150
2024-12-08 23:25:00,614 - evaluate - INFO - Evaluate V2: all_acc: 0.143 old_acc: 0.162 new_acc: 0.134
2024-12-08 23:25:00,615 - main - INFO - Averaged stats:
2024-12-08 23:25:00,615 - main - INFO - {'lr': 9.986128001799075e-05, 'loss_protop': 4.802241891622543, 'loss_feature': 3.764210134744644, 'loss_sep': 0.02259546349523589, 'loss_quan': 0.3339080810546875}
2024-12-08 23:25:00,616 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:25:16,778 - log_every - INFO - Epoch: [7]  [ 0/16]  eta: 0:04:18  lr: 0.000100  loss_protop: 4.7960 (4.7960)  loss_feature: 3.7398 (3.7398)  loss_sep: 0.0322 (0.0322)  loss_quan: 0.3381 (0.3381)  time: 16.1613  data: 15.9183  max mem: 3567
2024-12-08 23:25:26,822 - log_every - INFO - Epoch: [7]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.7960 (4.8013)  loss_feature: 3.7466 (3.7467)  loss_sep: 0.0169 (0.0198)  loss_quan: 0.3369 (0.3371)  time: 1.6378  data: 1.4685  max mem: 3567
2024-12-08 23:25:27,212 - log_every - INFO - Epoch: [7] Total time: 0:00:26 (1.6622 s / it)
2024-12-08 23:25:27,212 - evaluate - INFO - Start validation
2024-12-08 23:25:27,213 - evaluate - INFO - Radius: 1
2024-12-08 23:26:39,993 - evaluate - INFO - Evaluate V1: all_acc: 0.200 old_acc: 0.248 new_acc: 0.176
2024-12-08 23:26:40,001 - evaluate - INFO - Evaluate V2: all_acc: 0.155 old_acc: 0.142 new_acc: 0.162
2024-12-08 23:26:40,002 - main - INFO - Averaged stats:
2024-12-08 23:26:40,002 - main - INFO - {'lr': 9.98002884071386e-05, 'loss_protop': 4.801262974739075, 'loss_feature': 3.7466951310634613, 'loss_sep': 0.019800302456133068, 'loss_quan': 0.3371124267578125}
2024-12-08 23:26:40,003 - train_and_evaluate - INFO - Start train one epoch

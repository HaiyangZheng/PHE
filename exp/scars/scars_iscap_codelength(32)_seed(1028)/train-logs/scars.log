2024-12-08 23:48:20,091 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=32, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='scars', output_dir='exp//scars/scars_iscap_codelength(32)_seed(1028)', device='cuda', seed=1028, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/stanford_cars', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
2024-12-08 23:48:20,549 - main - INFO - train 2000 test: 3948
2024-12-08 23:48:20,549 - main - INFO - test_dataset_unlabelled: 6144
2024-12-08 23:48:24,118 - main - INFO - number of params: 14735680
2024-12-08 23:48:24,119 - main - INFO - Start training for 200 epochs
2024-12-08 23:48:24,119 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:48:55,298 - log_every - INFO - Epoch: [0]  [ 0/16]  eta: 0:08:18  lr: 0.000100  loss_protop: 4.7994 (4.7994)  loss_feature: 4.6145 (4.6145)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.6021 (0.6021)  time: 31.1783  data: 21.4225  max mem: 3396
2024-12-08 23:48:56,983 - log_every - INFO - Epoch: [0]  [15/16]  eta: 0:00:02  lr: 0.000100  loss_protop: 4.8958 (4.9092)  loss_feature: 4.3763 (4.4001)  loss_sep: 0.0000 (0.0035)  loss_quan: 0.5044 (0.5201)  time: 2.0539  data: 1.3390  max mem: 3567
2024-12-08 23:48:57,179 - log_every - INFO - Epoch: [0] Total time: 0:00:33 (2.0662 s / it)
2024-12-08 23:48:57,180 - evaluate - INFO - Start validation
2024-12-08 23:48:57,180 - evaluate - INFO - Radius: 5
2024-12-08 23:50:16,424 - evaluate - INFO - test len(list(set(preds1))): 489 len(preds): 6144
2024-12-08 23:50:16,424 - evaluate - INFO - Evaluate V1: all_acc: 0.114 old_acc: 0.137 new_acc: 0.102
2024-12-08 23:50:16,436 - evaluate - INFO - Evaluate V2: all_acc: 0.092 old_acc: 0.078 new_acc: 0.099
2024-12-08 23:50:16,438 - main - INFO - Averaged stats:
2024-12-08 23:50:16,438 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.909173458814621, 'loss_feature': 4.400073230266571, 'loss_sep': 0.0035176178280380554, 'loss_quan': 0.5200653076171875}
2024-12-08 23:50:16,439 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:50:35,706 - log_every - INFO - Epoch: [1]  [ 0/16]  eta: 0:05:08  lr: 0.000100  loss_protop: 4.9019 (4.9019)  loss_feature: 4.1224 (4.1224)  loss_sep: 0.0687 (0.0687)  loss_quan: 0.4465 (0.4465)  time: 19.2661  data: 19.0435  max mem: 3567
2024-12-08 23:50:43,438 - log_every - INFO - Epoch: [1]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9019 (4.9182)  loss_feature: 4.0371 (4.0421)  loss_sep: 0.0620 (0.0674)  loss_quan: 0.4250 (0.4281)  time: 1.6874  data: 1.5111  max mem: 3567
2024-12-08 23:50:43,907 - log_every - INFO - Epoch: [1] Total time: 0:00:27 (1.7167 s / it)
2024-12-08 23:50:43,907 - evaluate - INFO - Start validation
2024-12-08 23:50:43,908 - evaluate - INFO - Radius: 5

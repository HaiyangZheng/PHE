2024-12-08 23:27:37,427 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=12, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='food', output_dir='exp//food/food_iscap_seed(1029)', device='cuda', seed=1029, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
2024-12-08 23:27:42,906 - main - INFO - train 19125 test: 12750
2024-12-08 23:27:42,907 - main - INFO - test_dataset_unlabelled: 56625
2024-12-08 23:27:45,258 - main - INFO - number of params: 14369560
2024-12-08 23:27:45,258 - main - INFO - Start training for 200 epochs
2024-12-08 23:27:45,259 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:28:09,365 - log_every - INFO - Epoch: [0]  [  0/150]  eta: 1:00:15  lr: 0.000100  loss_protop: 4.2168 (4.2168)  loss_feature: 3.9803 (3.9803)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.6011 (0.6011)  time: 24.1051  data: 15.9381  max mem: 2686
2024-12-08 23:28:21,133 - log_every - INFO - Epoch: [0]  [ 30/150]  eta: 0:02:18  lr: 0.000100  loss_protop: 4.2950 (4.3043)  loss_feature: 3.3734 (3.4986)  loss_sep: 0.0559 (0.0385)  loss_quan: 0.3120 (0.3732)  time: 0.4966  data: 0.2411  max mem: 2851
2024-12-08 23:28:48,571 - log_every - INFO - Epoch: [0]  [ 60/150]  eta: 0:01:33  lr: 0.000100  loss_protop: 4.2507 (4.2757)  loss_feature: 3.2743 (3.3933)  loss_sep: 0.0146 (0.0272)  loss_quan: 0.2871 (0.3336)  time: 0.9077  data: 0.6558  max mem: 2851
2024-12-08 23:29:16,476 - log_every - INFO - Epoch: [0]  [ 90/150]  eta: 0:01:00  lr: 0.000100  loss_protop: 4.2381 (4.2670)  loss_feature: 3.2430 (3.3458)  loss_sep: 0.0075 (0.0211)  loss_quan: 0.2771 (0.3157)  time: 0.9095  data: 0.6507  max mem: 2851
2024-12-08 23:29:44,280 - log_every - INFO - Epoch: [0]  [120/150]  eta: 0:00:29  lr: 0.000100  loss_protop: 4.2159 (4.2489)  loss_feature: 3.2221 (3.3161)  loss_sep: 0.0082 (0.0176)  loss_quan: 0.2717 (0.3047)  time: 0.9390  data: 0.6872  max mem: 2851
2024-12-08 23:30:08,569 - log_every - INFO - Epoch: [0]  [149/150]  eta: 0:00:00  lr: 0.000100  loss_protop: 4.1993 (4.2388)  loss_feature: 3.2009 (3.2944)  loss_sep: 0.0053 (0.0154)  loss_quan: 0.2612 (0.2963)  time: 0.7907  data: 0.5634  max mem: 2851
2024-12-08 23:30:08,752 - log_every - INFO - Epoch: [0] Total time: 0:02:23 (0.9566 s / it)
2024-12-08 23:30:08,753 - evaluate - INFO - Start validation
2024-12-08 23:30:08,753 - evaluate - INFO - Radius: 1
2024-12-08 23:37:14,824 - evaluate - INFO - Evaluate V1: all_acc: 0.205 old_acc: 0.286 new_acc: 0.163
2024-12-08 23:37:14,856 - evaluate - INFO - Evaluate V2: all_acc: 0.164 old_acc: 0.215 new_acc: 0.139
2024-12-08 23:37:14,863 - main - INFO - Averaged stats:
2024-12-08 23:37:14,863 - main - INFO - {'lr': 9.999999999999976e-05, 'loss_protop': 4.238839511871338, 'loss_feature': 3.294449297587077, 'loss_sep': 0.015382966161123477, 'loss_quan': 0.296259765625}
2024-12-08 23:37:14,864 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:37:24,401 - log_every - INFO - Epoch: [1]  [  0/150]  eta: 0:23:50  lr: 0.000100  loss_protop: 4.1836 (4.1836)  loss_feature: 3.2012 (3.2012)  loss_sep: 0.0068 (0.0068)  loss_quan: 0.2627 (0.2627)  time: 9.5363  data: 9.1939  max mem: 3291
2024-12-08 23:37:51,547 - log_every - INFO - Epoch: [1]  [ 30/150]  eta: 0:02:21  lr: 0.000100  loss_protop: 4.1805 (4.1574)  loss_feature: 3.1579 (3.1641)  loss_sep: 0.0067 (0.0082)  loss_quan: 0.2549 (0.2567)  time: 0.9041  data: 0.6232  max mem: 3291
2024-12-08 23:38:18,837 - log_every - INFO - Epoch: [1]  [ 60/150]  eta: 0:01:34  lr: 0.000100  loss_protop: 4.1249 (4.1536)  loss_feature: 3.1592 (3.1626)  loss_sep: 0.0038 (0.0062)  loss_quan: 0.2581 (0.2565)  time: 0.9141  data: 0.6364  max mem: 3291
2024-12-08 23:38:47,701 - log_every - INFO - Epoch: [1]  [ 90/150]  eta: 0:01:01  lr: 0.000100  loss_protop: 4.1204 (4.1523)  loss_feature: 3.1525 (3.1594)  loss_sep: 0.0028 (0.0054)  loss_quan: 0.2537 (0.2563)  time: 0.8925  data: 0.6207  max mem: 3291
2024-12-08 23:39:15,182 - log_every - INFO - Epoch: [1]  [120/150]  eta: 0:00:29  lr: 0.000100  loss_protop: 4.1297 (4.1547)  loss_feature: 3.1501 (3.1573)  loss_sep: 0.0039 (0.0053)  loss_quan: 0.2473 (0.2544)  time: 0.8914  data: 0.6263  max mem: 3291
2024-12-08 23:39:33,552 - log_every - INFO - Epoch: [1]  [149/150]  eta: 0:00:00  lr: 0.000100  loss_protop: 4.1001 (4.1471)  loss_feature: 3.1472 (3.1562)  loss_sep: 0.0069 (0.0055)  loss_quan: 0.2465 (0.2527)  time: 0.7327  data: 0.5445  max mem: 3291
2024-12-08 23:39:33,964 - log_every - INFO - Epoch: [1] Total time: 0:02:19 (0.9273 s / it)
2024-12-08 23:39:33,964 - evaluate - INFO - Start validation
2024-12-08 23:39:33,964 - evaluate - INFO - Radius: 1
2024-12-08 23:46:29,220 - evaluate - INFO - Evaluate V1: all_acc: 0.225 old_acc: 0.354 new_acc: 0.159
2024-12-08 23:46:29,251 - evaluate - INFO - Evaluate V2: all_acc: 0.178 old_acc: 0.275 new_acc: 0.129
2024-12-08 23:46:29,257 - main - INFO - Averaged stats:
2024-12-08 23:46:29,258 - main - INFO - {'lr': 9.999999999999976e-05, 'loss_protop': 4.14708561261495, 'loss_feature': 3.1562089045842487, 'loss_sep': 0.005474367024580715, 'loss_quan': 0.25269124348958333}
2024-12-08 23:46:29,258 - train_and_evaluate - INFO - Start train one epoch
2024-12-08 23:46:39,110 - log_every - INFO - Epoch: [2]  [  0/150]  eta: 0:24:37  lr: 0.000100  loss_protop: 4.1672 (4.1672)  loss_feature: 3.1314 (3.1314)  loss_sep: 0.0061 (0.0061)  loss_quan: 0.2418 (0.2418)  time: 9.8509  data: 9.5457  max mem: 3291
2024-12-08 23:47:06,016 - log_every - INFO - Epoch: [2]  [ 30/150]  eta: 0:02:22  lr: 0.000100  loss_protop: 4.0796 (4.1022)  loss_feature: 3.1162 (3.1172)  loss_sep: 0.0086 (0.0084)  loss_quan: 0.2433 (0.2434)  time: 0.8977  data: 0.6134  max mem: 3291
2024-12-08 23:47:33,124 - log_every - INFO - Epoch: [2]  [ 60/150]  eta: 0:01:34  lr: 0.000100  loss_protop: 4.0938 (4.1033)  loss_feature: 3.1183 (3.1171)  loss_sep: 0.0086 (0.0082)  loss_quan: 0.2416 (0.2432)  time: 0.9102  data: 0.6368  max mem: 3291
2024-12-08 23:48:00,225 - log_every - INFO - Epoch: [2]  [ 90/150]  eta: 0:00:59  lr: 0.000100  loss_protop: 4.1046 (4.1010)  loss_feature: 3.1098 (3.1160)  loss_sep: 0.0048 (0.0077)  loss_quan: 0.2263 (0.2381)  time: 0.9042  data: 0.6376  max mem: 3291
2024-12-08 23:48:27,694 - log_every - INFO - Epoch: [2]  [120/150]  eta: 0:00:29  lr: 0.000100  loss_protop: 4.0465 (4.0879)  loss_feature: 3.1056 (3.1148)  loss_sep: 0.0038 (0.0072)  loss_quan: 0.2252 (0.2348)  time: 0.9119  data: 0.6372  max mem: 3291
2024-12-08 23:48:46,247 - log_every - INFO - Epoch: [2]  [149/150]  eta: 0:00:00  lr: 0.000100  loss_protop: 4.0304 (4.0837)  loss_feature: 3.1157 (3.1142)  loss_sep: 0.0035 (0.0069)  loss_quan: 0.2179 (0.2316)  time: 0.7594  data: 0.5569  max mem: 3291
2024-12-08 23:48:46,620 - log_every - INFO - Epoch: [2] Total time: 0:02:17 (0.9157 s / it)
2024-12-08 23:48:46,621 - evaluate - INFO - Start validation
2024-12-08 23:48:46,621 - evaluate - INFO - Radius: 1

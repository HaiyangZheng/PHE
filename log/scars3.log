2024-12-08 23:40:01,748 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=16, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='scars', output_dir='exp//scars/scars_iscap_codelength(16)_seed(1028)', device='cuda', seed=1028, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/stanford_cars', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
2024-12-08 23:40:02,154 - main - INFO - train 2000 test: 3948
2024-12-08 23:40:02,154 - main - INFO - test_dataset_unlabelled: 6144
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2024-12-08 23:40:06,116 - main - INFO - number of params: 14731552
2024-12-08 23:40:06,117 - main - INFO - Start training for 200 epochs
2024-12-08 23:40:06,117 - train_and_evaluate - INFO - Start train one epoch
train_classes: [1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
len(train_classes): 98
unlabeled_classes: [23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
len(unlabeled_classes): 98
require grad: prototype_vectors_global
require grad: features.blocks.11.norm1.weight
require grad: features.blocks.11.norm1.bias
require grad: features.blocks.11.attn.qkv.weight
require grad: features.blocks.11.attn.qkv.bias
require grad: features.blocks.11.attn.proj.weight
require grad: features.blocks.11.attn.proj.bias
require grad: features.blocks.11.norm2.weight
require grad: features.blocks.11.norm2.bias
require grad: features.blocks.11.mlp.fc1.weight
require grad: features.blocks.11.mlp.fc1.bias
require grad: features.blocks.11.mlp.fc2.weight
require grad: features.blocks.11.mlp.fc2.bias
require grad: add_on_layers.0.weight
require grad: add_on_layers.0.bias
require grad: hash_head.mlp.0.weight
require grad: hash_head.mlp.0.bias
require grad: hash_head.mlp.2.weight
require grad: hash_head.mlp.2.bias
require grad: hash_head.mlp.4.weight
require grad: hash_head.mlp.4.bias
require grad: hash_head.mlp.5.weight
require grad: hash_head.mlp.5.bias
require grad: hash_head.hash.weight
require grad: hash_head.bn_h.weight
require grad: hash_head.bn_h.bias
Param Group 0:
Parameters:
torch.Size([768])
torch.Size([768])
torch.Size([2304, 768])
torch.Size([2304])
torch.Size([768, 768])
torch.Size([768])
torch.Size([768])
torch.Size([768])
torch.Size([3072, 768])
torch.Size([3072])
torch.Size([768, 3072])
torch.Size([768])
Config:
lr: 0.0001
weight_decay: 0.001
betas: (0.9, 0.999)
eps: 1e-08
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 1:
Parameters:
torch.Size([768, 768])
torch.Size([768])
Config:
lr: 0.001
weight_decay: 0.001
betas: (0.9, 0.999)
eps: 1e-08
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 2:
Parameters:
torch.Size([2048, 768])
torch.Size([2048])
torch.Size([2048, 2048])
torch.Size([2048])
torch.Size([256, 2048])
torch.Size([256])
torch.Size([256])
torch.Size([256])
torch.Size([16, 256])
torch.Size([16])
torch.Size([16])
Config:
lr: 0.001
betas: (0.9, 0.999)
eps: 1e-08
weight_decay: 0.05
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 3:
Parameters:
torch.Size([980, 768])
Config:
lr: 0.001
betas: (0.9, 0.999)
eps: 1e-08
weight_decay: 0.05
amsgrad: False
foreach: None
maximize: False
capturable: False


d_max: 4
2024-12-08 23:40:36,871 - log_every - INFO - Epoch: [0]  [ 0/16]  eta: 0:08:12  lr: 0.000100  loss_protop: 4.8891 (4.8891)  loss_feature: 4.6326 (4.6326)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5947 (0.5947)  time: 30.7532  data: 21.8158  max mem: 3396
2024-12-08 23:40:38,556 - log_every - INFO - Epoch: [0]  [15/16]  eta: 0:00:02  lr: 0.000100  loss_protop: 4.9125 (4.9194)  loss_feature: 4.4041 (4.3887)  loss_sep: 0.0000 (0.0036)  loss_quan: 0.4497 (0.4747)  time: 2.0274  data: 1.3635  max mem: 3567
2024-12-08 23:40:38,740 - log_every - INFO - Epoch: [0] Total time: 0:00:32 (2.0389 s / it)
2024-12-08 23:40:38,740 - evaluate - INFO - Start validation
2024-12-08 23:40:38,740 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.9125 (4.9194)  loss_feature: 4.4041 (4.3887)  loss_sep: 0.0000 (0.0036)  loss_quan: 0.4497 (0.4747)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:25<09:35, 25.02s/it]  8%|▊         | 2/24 [00:25<03:57, 10.81s/it] 12%|█▎        | 3/24 [00:26<02:12,  6.29s/it] 17%|█▋        | 4/24 [00:27<01:22,  4.15s/it] 21%|██        | 5/24 [00:28<00:56,  2.97s/it] 25%|██▌       | 6/24 [00:29<00:40,  2.25s/it] 29%|██▉       | 7/24 [00:30<00:30,  1.80s/it] 33%|███▎      | 8/24 [00:31<00:24,  1.51s/it] 38%|███▊      | 9/24 [00:52<01:56,  7.77s/it] 42%|████▏     | 10/24 [00:53<01:18,  5.64s/it] 46%|████▌     | 11/24 [00:54<00:54,  4.18s/it] 50%|█████     | 12/24 [00:55<00:38,  3.18s/it] 54%|█████▍    | 13/24 [00:56<00:27,  2.49s/it] 58%|█████▊    | 14/24 [00:57<00:20,  2.00s/it] 62%|██████▎   | 15/24 [00:57<00:14,  1.66s/it] 67%|██████▋   | 16/24 [00:58<00:11,  1.42s/it] 71%|███████   | 17/24 [01:10<00:30,  4.36s/it] 75%|███████▌  | 18/24 [01:10<00:19,  3.22s/it] 79%|███████▉  | 19/24 [01:11<00:12,  2.42s/it] 83%|████████▎ | 20/24 [01:11<00:07,  1.86s/it] 88%|████████▊ | 21/24 [01:12<00:04,  1.47s/it] 92%|█████████▏| 22/24 [01:12<00:02,  1.19s/it] 96%|█████████▌| 23/24 [01:13<00:01,  1.00s/it]100%|██████████| 24/24 [01:13<00:00,  1.15it/s]100%|██████████| 24/24 [01:14<00:00,  3.09s/it]
2024-12-08 23:41:54,571 - evaluate - INFO - test len(list(set(preds1))): 212 len(preds): 6144
2024-12-08 23:41:54,571 - evaluate - INFO - Evaluate V1: all_acc: 0.110 old_acc: 0.128 new_acc: 0.102
2024-12-08 23:41:54,578 - evaluate - INFO - Evaluate V2: all_acc: 0.083 old_acc: 0.052 new_acc: 0.099
2024-12-08 23:41:54,579 - main - INFO - Averaged stats:
2024-12-08 23:41:54,579 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.919445604085922, 'loss_feature': 4.388652980327606, 'loss_sep': 0.0036496531683951616, 'loss_quan': 0.4747161865234375}
2024-12-08 23:41:54,580 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:42:12,257 - log_every - INFO - Epoch: [1]  [ 0/16]  eta: 0:04:42  lr: 0.000100  loss_protop: 4.7709 (4.7709)  loss_feature: 4.0749 (4.0749)  loss_sep: 0.0368 (0.0368)  loss_quan: 0.3794 (0.3794)  time: 17.6763  data: 17.4622  max mem: 3567
2024-12-08 23:42:21,260 - log_every - INFO - Epoch: [1]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9174 (4.8961)  loss_feature: 4.0030 (4.0099)  loss_sep: 0.0465 (0.0509)  loss_quan: 0.3589 (0.3610)  time: 1.6674  data: 1.5016  max mem: 3567
2024-12-08 23:42:21,574 - log_every - INFO - Epoch: [1] Total time: 0:00:26 (1.6871 s / it)
2024-12-08 23:42:21,575 - evaluate - INFO - Start validation
2024-12-08 23:42:21,575 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.9174 (4.8961)  loss_feature: 4.0030 (4.0099)  loss_sep: 0.0465 (0.0509)  loss_quan: 0.3589 (0.3610)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:20, 24.36s/it]  8%|▊         | 2/24 [00:25<03:52, 10.56s/it] 12%|█▎        | 3/24 [00:26<02:08,  6.14s/it] 17%|█▋        | 4/24 [00:27<01:21,  4.08s/it] 21%|██        | 5/24 [00:28<00:56,  2.95s/it] 25%|██▌       | 6/24 [00:28<00:40,  2.26s/it] 29%|██▉       | 7/24 [00:29<00:30,  1.81s/it] 33%|███▎      | 8/24 [00:30<00:24,  1.52s/it] 38%|███▊      | 9/24 [00:51<01:54,  7.60s/it] 42%|████▏     | 10/24 [00:52<01:17,  5.53s/it] 46%|████▌     | 11/24 [00:53<00:53,  4.11s/it] 50%|█████     | 12/24 [00:54<00:37,  3.13s/it] 54%|█████▍    | 13/24 [00:55<00:26,  2.45s/it] 58%|█████▊    | 14/24 [00:56<00:19,  1.97s/it] 62%|██████▎   | 15/24 [00:57<00:14,  1.65s/it] 67%|██████▋   | 16/24 [00:57<00:11,  1.42s/it] 71%|███████   | 17/24 [01:08<00:28,  4.09s/it] 75%|███████▌  | 18/24 [01:08<00:18,  3.02s/it] 79%|███████▉  | 19/24 [01:09<00:11,  2.28s/it] 83%|████████▎ | 20/24 [01:09<00:07,  1.76s/it] 88%|████████▊ | 21/24 [01:10<00:04,  1.40s/it] 92%|█████████▏| 22/24 [01:10<00:02,  1.15s/it] 96%|█████████▌| 23/24 [01:11<00:00,  1.03it/s]100%|██████████| 24/24 [01:12<00:00,  1.19it/s]100%|██████████| 24/24 [01:12<00:00,  3.02s/it]
2024-12-08 23:43:35,596 - evaluate - INFO - test len(list(set(preds1))): 213 len(preds): 6144
2024-12-08 23:43:35,596 - evaluate - INFO - Evaluate V1: all_acc: 0.131 old_acc: 0.158 new_acc: 0.117
2024-12-08 23:43:35,603 - evaluate - INFO - Evaluate V2: all_acc: 0.098 old_acc: 0.070 new_acc: 0.111
2024-12-08 23:43:35,604 - main - INFO - Averaged stats:
2024-12-08 23:43:35,605 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.896111160516739, 'loss_feature': 4.0099382400512695, 'loss_sep': 0.05090581072727218, 'loss_quan': 0.3610076904296875}
2024-12-08 23:43:35,605 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:43:51,259 - log_every - INFO - Epoch: [2]  [ 0/16]  eta: 0:04:10  lr: 0.000100  loss_protop: 4.9399 (4.9399)  loss_feature: 3.9105 (3.9105)  loss_sep: 0.0095 (0.0095)  loss_quan: 0.3506 (0.3506)  time: 15.6528  data: 15.3973  max mem: 3567
2024-12-08 23:44:02,111 - log_every - INFO - Epoch: [2]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8562 (4.8559)  loss_feature: 3.8972 (3.8970)  loss_sep: 0.0180 (0.0286)  loss_quan: 0.3396 (0.3414)  time: 1.6565  data: 1.4726  max mem: 3567
2024-12-08 23:44:02,431 - log_every - INFO - Epoch: [2] Total time: 0:00:26 (1.6766 s / it)
2024-12-08 23:44:02,432 - evaluate - INFO - Start validation
2024-12-08 23:44:02,432 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8562 (4.8559)  loss_feature: 3.8972 (3.8970)  loss_sep: 0.0180 (0.0286)  loss_quan: 0.3396 (0.3414)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:22, 24.44s/it]  8%|▊         | 2/24 [00:25<03:53, 10.60s/it] 12%|█▎        | 3/24 [00:26<02:09,  6.18s/it] 17%|█▋        | 4/24 [00:27<01:22,  4.11s/it] 21%|██        | 5/24 [00:28<00:56,  2.96s/it] 25%|██▌       | 6/24 [00:29<00:40,  2.27s/it] 29%|██▉       | 7/24 [00:29<00:31,  1.83s/it] 33%|███▎      | 8/24 [00:30<00:24,  1.54s/it] 38%|███▊      | 9/24 [00:51<01:53,  7.57s/it] 42%|████▏     | 10/24 [00:52<01:17,  5.50s/it] 46%|████▌     | 11/24 [00:53<00:53,  4.09s/it] 50%|█████     | 12/24 [00:54<00:37,  3.11s/it] 54%|█████▍    | 13/24 [00:55<00:26,  2.44s/it] 58%|█████▊    | 14/24 [00:56<00:19,  1.97s/it] 62%|██████▎   | 15/24 [00:57<00:14,  1.65s/it] 67%|██████▋   | 16/24 [00:57<00:11,  1.42s/it] 71%|███████   | 17/24 [01:08<00:29,  4.19s/it] 75%|███████▌  | 18/24 [01:09<00:18,  3.10s/it] 79%|███████▉  | 19/24 [01:09<00:11,  2.34s/it] 83%|████████▎ | 20/24 [01:10<00:07,  1.80s/it] 88%|████████▊ | 21/24 [01:10<00:04,  1.43s/it] 92%|█████████▏| 22/24 [01:11<00:02,  1.17s/it] 96%|█████████▌| 23/24 [01:11<00:00,  1.02it/s]100%|██████████| 24/24 [01:12<00:00,  1.17it/s]100%|██████████| 24/24 [01:12<00:00,  3.03s/it]
2024-12-08 23:45:16,821 - evaluate - INFO - test len(list(set(preds1))): 185 len(preds): 6144
2024-12-08 23:45:16,822 - evaluate - INFO - Evaluate V1: all_acc: 0.169 old_acc: 0.212 new_acc: 0.148
2024-12-08 23:45:16,828 - evaluate - INFO - Evaluate V2: all_acc: 0.124 old_acc: 0.101 new_acc: 0.135
2024-12-08 23:45:16,829 - main - INFO - Averaged stats:
2024-12-08 23:45:16,829 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.855858534574509, 'loss_feature': 3.8969842940568924, 'loss_sep': 0.028574417519848794, 'loss_quan': 0.3413848876953125}
2024-12-08 23:45:16,830 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:45:33,487 - log_every - INFO - Epoch: [3]  [ 0/16]  eta: 0:04:26  lr: 0.000100  loss_protop: 4.8889 (4.8889)  loss_feature: 3.8362 (3.8362)  loss_sep: 0.0173 (0.0173)  loss_quan: 0.3379 (0.3379)  time: 16.6560  data: 16.4139  max mem: 3567
2024-12-08 23:45:43,438 - log_every - INFO - Epoch: [3]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8465 (4.8702)  loss_feature: 3.8357 (3.8343)  loss_sep: 0.0251 (0.0275)  loss_quan: 0.3352 (0.3351)  time: 1.6629  data: 1.4824  max mem: 3567
2024-12-08 23:45:43,772 - log_every - INFO - Epoch: [3] Total time: 0:00:26 (1.6838 s / it)
2024-12-08 23:45:43,772 - evaluate - INFO - Start validation
2024-12-08 23:45:43,772 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8465 (4.8702)  loss_feature: 3.8357 (3.8343)  loss_sep: 0.0251 (0.0275)  loss_quan: 0.3352 (0.3351)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:24, 24.54s/it]  8%|▊         | 2/24 [00:25<03:53, 10.63s/it] 12%|█▎        | 3/24 [00:26<02:10,  6.19s/it] 17%|█▋        | 4/24 [00:27<01:22,  4.10s/it] 21%|██        | 5/24 [00:28<00:56,  2.95s/it] 25%|██▌       | 6/24 [00:29<00:40,  2.26s/it] 29%|██▉       | 7/24 [00:29<00:30,  1.82s/it] 33%|███▎      | 8/24 [00:30<00:24,  1.53s/it] 38%|███▊      | 9/24 [00:51<01:50,  7.40s/it] 42%|████▏     | 10/24 [00:52<01:15,  5.38s/it] 46%|████▌     | 11/24 [00:52<00:52,  4.00s/it] 50%|█████     | 12/24 [00:53<00:36,  3.06s/it] 54%|█████▍    | 13/24 [00:54<00:26,  2.40s/it] 58%|█████▊    | 14/24 [00:55<00:19,  1.94s/it] 62%|██████▎   | 15/24 [00:56<00:14,  1.63s/it] 67%|██████▋   | 16/24 [00:57<00:11,  1.41s/it] 71%|███████   | 17/24 [01:08<00:29,  4.28s/it] 75%|███████▌  | 18/24 [01:08<00:18,  3.16s/it] 79%|███████▉  | 19/24 [01:09<00:11,  2.38s/it] 83%|████████▎ | 20/24 [01:10<00:07,  1.83s/it] 88%|████████▊ | 21/24 [01:10<00:04,  1.45s/it] 92%|█████████▏| 22/24 [01:11<00:02,  1.18s/it] 96%|█████████▌| 23/24 [01:11<00:00,  1.01it/s]100%|██████████| 24/24 [01:12<00:00,  1.16it/s]100%|██████████| 24/24 [01:12<00:00,  3.02s/it]
2024-12-08 23:46:57,932 - evaluate - INFO - test len(list(set(preds1))): 189 len(preds): 6144
2024-12-08 23:46:57,932 - evaluate - INFO - Evaluate V1: all_acc: 0.166 old_acc: 0.211 new_acc: 0.144
2024-12-08 23:46:57,938 - evaluate - INFO - Evaluate V2: all_acc: 0.121 old_acc: 0.111 new_acc: 0.126
2024-12-08 23:46:57,940 - main - INFO - Averaged stats:
2024-12-08 23:46:57,940 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.87017896771431, 'loss_feature': 3.8342813551425934, 'loss_sep': 0.027485750091727823, 'loss_quan': 0.3351287841796875}
2024-12-08 23:46:57,941 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:47:15,734 - log_every - INFO - Epoch: [4]  [ 0/16]  eta: 0:04:44  lr: 0.000100  loss_protop: 4.8143 (4.8143)  loss_feature: 3.7932 (3.7932)  loss_sep: 0.0309 (0.0309)  loss_quan: 0.3333 (0.3333)  time: 17.7932  data: 17.5854  max mem: 3567
2024-12-08 23:47:24,631 - log_every - INFO - Epoch: [4]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8219 (4.8474)  loss_feature: 3.8137 (3.8101)  loss_sep: 0.0153 (0.0173)  loss_quan: 0.3342 (0.3342)  time: 1.6681  data: 1.4977  max mem: 3567
2024-12-08 23:47:24,955 - log_every - INFO - Epoch: [4] Total time: 0:00:27 (1.6884 s / it)
2024-12-08 23:47:24,955 - evaluate - INFO - Start validation
2024-12-08 23:47:24,955 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8219 (4.8474)  loss_feature: 3.8137 (3.8101)  loss_sep: 0.0153 (0.0173)  loss_quan: 0.3342 (0.3342)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:21, 24.43s/it]  8%|▊         | 2/24 [00:25<03:53, 10.60s/it] 12%|█▎        | 3/24 [00:26<02:09,  6.17s/it] 17%|█▋        | 4/24 [00:27<01:21,  4.09s/it] 21%|██        | 5/24 [00:28<00:56,  2.95s/it] 25%|██▌       | 6/24 [00:29<00:40,  2.26s/it] 29%|██▉       | 7/24 [00:29<00:31,  1.83s/it] 33%|███▎      | 8/24 [00:30<00:24,  1.53s/it] 38%|███▊      | 9/24 [00:51<01:53,  7.57s/it] 42%|████▏     | 10/24 [00:52<01:17,  5.51s/it] 46%|████▌     | 11/24 [00:53<00:53,  4.10s/it] 50%|█████     | 12/24 [00:54<00:37,  3.12s/it] 54%|█████▍    | 13/24 [00:55<00:26,  2.44s/it] 58%|█████▊    | 14/24 [00:56<00:19,  1.96s/it] 62%|██████▎   | 15/24 [00:56<00:14,  1.64s/it] 67%|██████▋   | 16/24 [00:57<00:11,  1.42s/it] 71%|███████   | 17/24 [01:08<00:29,  4.24s/it] 75%|███████▌  | 18/24 [01:09<00:18,  3.13s/it] 79%|███████▉  | 19/24 [01:09<00:11,  2.36s/it] 83%|████████▎ | 20/24 [01:10<00:07,  1.82s/it] 88%|████████▊ | 21/24 [01:10<00:04,  1.44s/it] 92%|█████████▏| 22/24 [01:11<00:02,  1.17s/it] 96%|█████████▌| 23/24 [01:12<00:00,  1.01it/s]100%|██████████| 24/24 [01:12<00:00,  1.16it/s]100%|██████████| 24/24 [01:12<00:00,  3.04s/it]
2024-12-08 23:48:39,617 - evaluate - INFO - test len(list(set(preds1))): 215 len(preds): 6144
2024-12-08 23:48:39,617 - evaluate - INFO - Evaluate V1: all_acc: 0.180 old_acc: 0.220 new_acc: 0.160
2024-12-08 23:48:39,624 - evaluate - INFO - Evaluate V2: all_acc: 0.139 old_acc: 0.121 new_acc: 0.148
2024-12-08 23:48:39,626 - main - INFO - Averaged stats:
2024-12-08 23:48:39,626 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.847430169582367, 'loss_feature': 3.8101312667131424, 'loss_sep': 0.017251773446332663, 'loss_quan': 0.3341522216796875}
2024-12-08 23:48:39,627 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:48:53,993 - log_every - INFO - Epoch: [5]  [ 0/16]  eta: 0:03:49  lr: 0.000100  loss_protop: 4.7095 (4.7095)  loss_feature: 3.7780 (3.7780)  loss_sep: 0.0157 (0.0157)  loss_quan: 0.3306 (0.3306)  time: 14.3662  data: 14.1241  max mem: 3567
2024-12-08 23:49:06,125 - log_every - INFO - Epoch: [5]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8410 (4.8547)  loss_feature: 3.7815 (3.7822)  loss_sep: 0.0204 (0.0213)  loss_quan: 0.3306 (0.3297)  time: 1.6561  data: 1.4800  max mem: 3567
2024-12-08 23:49:06,440 - log_every - INFO - Epoch: [5] Total time: 0:00:26 (1.6758 s / it)
2024-12-08 23:49:06,440 - evaluate - INFO - Start validation
2024-12-08 23:49:06,440 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8410 (4.8547)  loss_feature: 3.7815 (3.7822)  loss_sep: 0.0204 (0.0213)  loss_quan: 0.3306 (0.3297)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:22, 24.46s/it]  8%|▊         | 2/24 [00:25<03:53, 10.60s/it] 12%|█▎        | 3/24 [00:26<02:09,  6.19s/it] 17%|█▋        | 4/24 [00:27<01:22,  4.11s/it] 21%|██        | 5/24 [00:28<00:56,  2.96s/it] 25%|██▌       | 6/24 [00:29<00:40,  2.27s/it] 29%|██▉       | 7/24 [00:29<00:31,  1.83s/it] 33%|███▎      | 8/24 [00:30<00:24,  1.54s/it] 38%|███▊      | 9/24 [00:51<01:53,  7.58s/it] 42%|████▏     | 10/24 [00:52<01:17,  5.50s/it] 46%|████▌     | 11/24 [00:53<00:53,  4.08s/it] 50%|█████     | 12/24 [00:54<00:37,  3.11s/it] 54%|█████▍    | 13/24 [00:55<00:26,  2.43s/it] 58%|█████▊    | 14/24 [00:56<00:19,  1.96s/it] 62%|██████▎   | 15/24 [00:57<00:14,  1.64s/it] 67%|██████▋   | 16/24 [00:57<00:11,  1.42s/it] 71%|███████   | 17/24 [01:09<00:30,  4.33s/it] 75%|███████▌  | 18/24 [01:09<00:19,  3.19s/it] 79%|███████▉  | 19/24 [01:10<00:12,  2.40s/it] 83%|████████▎ | 20/24 [01:10<00:07,  1.85s/it] 88%|████████▊ | 21/24 [01:11<00:04,  1.46s/it] 92%|█████████▏| 22/24 [01:11<00:02,  1.19s/it] 96%|█████████▌| 23/24 [01:12<00:01,  1.00s/it]100%|██████████| 24/24 [01:12<00:00,  1.15it/s]100%|██████████| 24/24 [01:13<00:00,  3.05s/it]
2024-12-08 23:50:21,549 - evaluate - INFO - test len(list(set(preds1))): 236 len(preds): 6144
2024-12-08 23:50:21,549 - evaluate - INFO - Evaluate V1: all_acc: 0.200 old_acc: 0.252 new_acc: 0.175
2024-12-08 23:50:21,557 - evaluate - INFO - Evaluate V2: all_acc: 0.158 old_acc: 0.162 new_acc: 0.156
2024-12-08 23:50:21,558 - main - INFO - Averaged stats:
2024-12-08 23:50:21,558 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.854669392108917, 'loss_feature': 3.7821779251098633, 'loss_sep': 0.021285076218191534, 'loss_quan': 0.3296661376953125}
2024-12-08 23:50:21,559 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:50:38,070 - log_every - INFO - Epoch: [6]  [ 0/16]  eta: 0:04:24  lr: 0.000100  loss_protop: 4.9109 (4.9109)  loss_feature: 3.7554 (3.7554)  loss_sep: 0.0190 (0.0190)  loss_quan: 0.3274 (0.3274)  time: 16.5102  data: 16.2868  max mem: 3567
2024-12-08 23:50:48,436 - log_every - INFO - Epoch: [6]  [15/16]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8367 (4.8299)  loss_feature: 3.7558 (3.7562)  loss_sep: 0.0142 (0.0137)  loss_quan: 0.3274 (0.3276)  time: 1.6797  data: 1.5071  max mem: 3567
2024-12-08 23:50:48,767 - log_every - INFO - Epoch: [6] Total time: 0:00:27 (1.7005 s / it)
2024-12-08 23:50:48,767 - evaluate - INFO - Start validation
2024-12-08 23:50:48,767 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8367 (4.8299)  loss_feature: 3.7558 (3.7562)  loss_sep: 0.0142 (0.0137)  loss_quan: 0.3274 (0.3276)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:24<09:31, 24.84s/it]  8%|▊         | 2/24 [00:25<03:56, 10.75s/it] 12%|█▎        | 3/24 [00:26<02:11,  6.26s/it] 17%|█▋        | 4/24 [00:27<01:23,  4.16s/it] 21%|██        | 5/24 [00:28<00:56,  2.98s/it] 25%|██▌       | 6/24 [00:29<00:41,  2.28s/it] 29%|██▉       | 7/24 [00:30<00:31,  1.83s/it] 33%|███▎      | 8/24 [00:31<00:24,  1.54s/it] 38%|███▊      | 9/24 [00:52<01:55,  7.70s/it] 42%|████▏     | 10/24 [00:53<01:18,  5.61s/it] 46%|████▌     | 11/24 [00:54<00:54,  4.17s/it] 50%|█████     | 12/24 [00:55<00:38,  3.19s/it] 54%|█████▍    | 13/24 [00:56<00:27,  2.50s/it] 58%|█████▊    | 14/24 [00:57<00:20,  2.03s/it] 62%|██████▎   | 15/24 [00:58<00:15,  1.70s/it] 67%|██████▋   | 16/24 [00:58<00:11,  1.47s/it]
2024-12-08 23:46:14,376 - main - INFO - Start running with args: 
Namespace(batch_size=128, img_size=224, prototype_shape=[2000, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', use_global=True, global_proto_per_class=10, epochs=200, save_ep_freq=10, hash_code_length=16, prototype_dim=768, alpha=0.1, beta=3.0, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, prop_train_labels=0.5, mask_theta=0.1, labeled_nums=0, unlabeled_nums=0, data_set='cub', output_dir='exp//cub/cub_iscap_codelength(16)_seed(1027)', device='cuda', seed=1027, resume='', start_epoch=0, eval=False, num_workers=10, pin_mem=True, data_root='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB', pretrain_path='/leonardo_work/IscrC_Fed-GCD/GCD_datasets/dino/dino_vitbase16_pretrain.pth')
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
2024-12-08 23:46:18,806 - main - INFO - train 1498 test: 2884
2024-12-08 23:46:18,806 - main - INFO - test_dataset_unlabelled: 4496
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/leonardo/home/userexternal/hzheng00/miniconda3/envs/fedgcd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2024-12-08 23:46:22,307 - main - INFO - number of params: 14746912
2024-12-08 23:46:22,308 - main - INFO - Start training for 200 epochs
2024-12-08 23:46:22,309 - train_and_evaluate - INFO - Start train one epoch
Files already downloaded and verified
train_classes: [150, 70, 34, 178, 199, 131, 129, 147, 134, 11, 26, 93, 95, 121, 123, 99, 149, 167, 18, 31, 69, 198, 116, 158, 126, 17, 5, 179, 111, 163, 184, 81, 174, 42, 53, 89, 77, 55, 23, 48, 43, 44, 56, 28, 193, 143, 0, 176, 84, 15, 38, 154, 141, 190, 172, 124, 189, 19, 80, 157, 12, 9, 79, 30, 94, 67, 197, 97, 168, 137, 119, 76, 98, 88, 40, 106, 171, 87, 166, 186, 27, 51, 144, 135, 161, 64, 177, 7, 146, 61, 50, 162, 133, 82, 39, 74, 72, 91, 196, 136]
len(train_classes): 100
unlabeled_classes: [29, 110, 3, 8, 13, 58, 142, 25, 145, 63, 59, 65, 24, 140, 120, 32, 114, 107, 160, 130, 118, 101, 115, 128, 117, 71, 156, 112, 36, 122, 104, 102, 90, 125, 152, 195, 132, 83, 22, 192, 153, 175, 191, 155, 49, 194, 73, 66, 170, 151, 169, 96, 103, 37, 181, 127, 78, 21, 10, 164, 62, 2, 183, 85, 45, 60, 92, 185, 20, 159, 173, 148, 1, 57, 113, 165, 52, 109, 14, 4, 180, 6, 182, 68, 33, 108, 46, 35, 75, 188, 187, 100, 47, 105, 41, 86, 16, 54, 139, 138]
len(unlabeled_classes): 100
require grad: prototype_vectors_global
require grad: features.blocks.11.norm1.weight
require grad: features.blocks.11.norm1.bias
require grad: features.blocks.11.attn.qkv.weight
require grad: features.blocks.11.attn.qkv.bias
require grad: features.blocks.11.attn.proj.weight
require grad: features.blocks.11.attn.proj.bias
require grad: features.blocks.11.norm2.weight
require grad: features.blocks.11.norm2.bias
require grad: features.blocks.11.mlp.fc1.weight
require grad: features.blocks.11.mlp.fc1.bias
require grad: features.blocks.11.mlp.fc2.weight
require grad: features.blocks.11.mlp.fc2.bias
require grad: add_on_layers.0.weight
require grad: add_on_layers.0.bias
require grad: hash_head.mlp.0.weight
require grad: hash_head.mlp.0.bias
require grad: hash_head.mlp.2.weight
require grad: hash_head.mlp.2.bias
require grad: hash_head.mlp.4.weight
require grad: hash_head.mlp.4.bias
require grad: hash_head.mlp.5.weight
require grad: hash_head.mlp.5.bias
require grad: hash_head.hash.weight
require grad: hash_head.bn_h.weight
require grad: hash_head.bn_h.bias
Param Group 0:
Parameters:
torch.Size([768])
torch.Size([768])
torch.Size([2304, 768])
torch.Size([2304])
torch.Size([768, 768])
torch.Size([768])
torch.Size([768])
torch.Size([768])
torch.Size([3072, 768])
torch.Size([3072])
torch.Size([768, 3072])
torch.Size([768])
Config:
lr: 0.0001
weight_decay: 0.001
betas: (0.9, 0.999)
eps: 1e-08
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 1:
Parameters:
torch.Size([768, 768])
torch.Size([768])
Config:
lr: 0.001
weight_decay: 0.001
betas: (0.9, 0.999)
eps: 1e-08
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 2:
Parameters:
torch.Size([2048, 768])
torch.Size([2048])
torch.Size([2048, 2048])
torch.Size([2048])
torch.Size([256, 2048])
torch.Size([256])
torch.Size([256])
torch.Size([256])
torch.Size([16, 256])
torch.Size([16])
torch.Size([16])
Config:
lr: 0.001
betas: (0.9, 0.999)
eps: 1e-08
weight_decay: 0.05
amsgrad: False
foreach: None
maximize: False
capturable: False


Param Group 3:
Parameters:
torch.Size([1000, 768])
Config:
lr: 0.001
betas: (0.9, 0.999)
eps: 1e-08
weight_decay: 0.05
amsgrad: False
foreach: None
maximize: False
capturable: False


d_max: 4
2024-12-08 23:46:41,775 - log_every - INFO - Epoch: [0]  [ 0/12]  eta: 0:03:53  lr: 0.000100  loss_protop: 4.8815 (4.8815)  loss_feature: 4.6320 (4.6320)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5864 (0.5864)  time: 19.4622  data: 13.5474  max mem: 3428
2024-12-08 23:46:43,013 - log_every - INFO - Epoch: [0]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9252 (4.9325)  loss_feature: 4.2991 (4.3363)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5015 (0.5118)  time: 1.7249  data: 1.1290  max mem: 3597
2024-12-08 23:46:43,223 - log_every - INFO - Epoch: [0] Total time: 0:00:20 (1.7429 s / it)
2024-12-08 23:46:43,227 - evaluate - INFO - Start validation
2024-12-08 23:46:43,227 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.9252 (4.9325)  loss_feature: 4.2991 (4.3363)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.5015 (0.5118)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:11, 14.82s/it] 11%|█         | 2/18 [00:16<01:50,  6.92s/it] 17%|█▋        | 3/18 [00:17<01:02,  4.17s/it] 22%|██▏       | 4/18 [00:18<00:40,  2.88s/it] 28%|██▊       | 5/18 [00:18<00:28,  2.18s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.74s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.47s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.29s/it] 50%|█████     | 9/18 [00:30<00:31,  3.50s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.63s/it] 61%|██████    | 11/18 [00:31<00:14,  2.03s/it] 67%|██████▋   | 12/18 [00:32<00:09,  1.61s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.32s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.12s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.18it/s] 94%|█████████▍| 17/18 [00:35<00:00,  1.31it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.99s/it]
2024-12-08 23:47:20,542 - evaluate - INFO - test len(list(set(preds1))): 290 len(preds): 4496
2024-12-08 23:47:20,542 - evaluate - INFO - Evaluate V1: all_acc: 0.175 old_acc: 0.199 new_acc: 0.163
2024-12-08 23:47:20,550 - evaluate - INFO - Evaluate V2: all_acc: 0.145 old_acc: 0.127 new_acc: 0.153
2024-12-08 23:47:20,551 - main - INFO - Averaged stats:
2024-12-08 23:47:20,551 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.9325162172317505, 'loss_feature': 4.336271365483602, 'loss_sep': 0.0, 'loss_quan': 0.5117594401041666}
2024-12-08 23:47:20,552 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:47:30,536 - log_every - INFO - Epoch: [1]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.9725 (4.9725)  loss_feature: 3.9544 (3.9544)  loss_sep: 0.0000 (0.0000)  loss_quan: 0.4238 (0.4238)  time: 9.9833  data: 9.7625  max mem: 3597
2024-12-08 23:47:32,793 - log_every - INFO - Epoch: [1]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9329 (4.9184)  loss_feature: 3.9000 (3.9052)  loss_sep: 0.0000 (0.0056)  loss_quan: 0.3914 (0.3963)  time: 1.0200  data: 0.8712  max mem: 3597
2024-12-08 23:47:33,240 - log_every - INFO - Epoch: [1] Total time: 0:00:12 (1.0574 s / it)
2024-12-08 23:47:33,241 - evaluate - INFO - Start validation
2024-12-08 23:47:33,241 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.9329 (4.9184)  loss_feature: 3.9000 (3.9052)  loss_sep: 0.0000 (0.0056)  loss_quan: 0.3914 (0.3963)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:08, 14.65s/it] 11%|█         | 2/18 [00:15<01:47,  6.70s/it] 17%|█▋        | 3/18 [00:16<01:01,  4.07s/it] 22%|██▏       | 4/18 [00:17<00:39,  2.82s/it] 28%|██▊       | 5/18 [00:18<00:27,  2.13s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.72s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.46s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.29s/it] 50%|█████     | 9/18 [00:29<00:31,  3.56s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.67s/it] 61%|██████    | 11/18 [00:31<00:14,  2.06s/it] 67%|██████▋   | 12/18 [00:31<00:09,  1.63s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.34s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.12s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.17it/s] 94%|█████████▍| 17/18 [00:34<00:00,  1.30it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.98s/it]
2024-12-08 23:48:10,600 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 4496
2024-12-08 23:48:10,600 - evaluate - INFO - Evaluate V1: all_acc: 0.204 old_acc: 0.241 new_acc: 0.185
2024-12-08 23:48:10,609 - evaluate - INFO - Evaluate V2: all_acc: 0.170 old_acc: 0.160 new_acc: 0.175
2024-12-08 23:48:10,610 - main - INFO - Averaged stats:
2024-12-08 23:48:10,610 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.918416500091553, 'loss_feature': 3.9051726261774697, 'loss_sep': 0.0056087239645421505, 'loss_quan': 0.3963216145833333}
2024-12-08 23:48:10,611 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:48:20,532 - log_every - INFO - Epoch: [2]  [ 0/12]  eta: 0:01:59  lr: 0.000100  loss_protop: 4.9583 (4.9583)  loss_feature: 3.8163 (3.8163)  loss_sep: 0.0153 (0.0153)  loss_quan: 0.3779 (0.3779)  time: 9.9206  data: 9.7062  max mem: 3597
2024-12-08 23:48:22,857 - log_every - INFO - Epoch: [2]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.9313 (4.9315)  loss_feature: 3.8022 (3.8021)  loss_sep: 0.0109 (0.0122)  loss_quan: 0.3601 (0.3622)  time: 1.0204  data: 0.8725  max mem: 3597
2024-12-08 23:48:23,293 - log_every - INFO - Epoch: [2] Total time: 0:00:12 (1.0568 s / it)
2024-12-08 23:48:23,293 - evaluate - INFO - Start validation
2024-12-08 23:48:23,294 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.9313 (4.9315)  loss_feature: 3.8022 (3.8021)  loss_sep: 0.0109 (0.0122)  loss_quan: 0.3601 (0.3622)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:09, 14.66s/it] 11%|█         | 2/18 [00:15<01:47,  6.75s/it] 17%|█▋        | 3/18 [00:16<01:01,  4.09s/it] 22%|██▏       | 4/18 [00:17<00:39,  2.83s/it] 28%|██▊       | 5/18 [00:18<00:27,  2.15s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.73s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.48s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.30s/it] 50%|█████     | 9/18 [00:29<00:31,  3.53s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.65s/it] 61%|██████    | 11/18 [00:31<00:14,  2.04s/it] 67%|██████▋   | 12/18 [00:31<00:09,  1.62s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.32s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.12s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.18it/s] 94%|█████████▍| 17/18 [00:34<00:00,  1.31it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.98s/it]
2024-12-08 23:49:00,531 - evaluate - INFO - test len(list(set(preds1))): 320 len(preds): 4496
2024-12-08 23:49:00,531 - evaluate - INFO - Evaluate V1: all_acc: 0.242 old_acc: 0.286 new_acc: 0.221
2024-12-08 23:49:00,539 - evaluate - INFO - Evaluate V2: all_acc: 0.198 old_acc: 0.187 new_acc: 0.203
2024-12-08 23:49:00,541 - main - INFO - Averaged stats:
2024-12-08 23:49:00,541 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.9315182367960615, 'loss_feature': 3.8021169304847717, 'loss_sep': 0.012171223759651184, 'loss_quan': 0.36224365234375}
2024-12-08 23:49:00,542 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:49:10,614 - log_every - INFO - Epoch: [3]  [ 0/12]  eta: 0:02:00  lr: 0.000100  loss_protop: 4.7875 (4.7875)  loss_feature: 3.7559 (3.7559)  loss_sep: 0.0073 (0.0073)  loss_quan: 0.3440 (0.3440)  time: 10.0716  data: 9.9084  max mem: 3597
2024-12-08 23:49:12,765 - log_every - INFO - Epoch: [3]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8380 (4.8557)  loss_feature: 3.7547 (3.7559)  loss_sep: 0.0073 (0.0091)  loss_quan: 0.3320 (0.3340)  time: 1.0185  data: 0.8696  max mem: 3597
2024-12-08 23:49:13,205 - log_every - INFO - Epoch: [3] Total time: 0:00:12 (1.0552 s / it)
2024-12-08 23:49:13,205 - evaluate - INFO - Start validation
2024-12-08 23:49:13,205 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8380 (4.8557)  loss_feature: 3.7547 (3.7559)  loss_sep: 0.0073 (0.0091)  loss_quan: 0.3320 (0.3340)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:09, 14.67s/it] 11%|█         | 2/18 [00:15<01:47,  6.74s/it] 17%|█▋        | 3/18 [00:16<01:01,  4.09s/it] 22%|██▏       | 4/18 [00:17<00:39,  2.83s/it] 28%|██▊       | 5/18 [00:18<00:27,  2.14s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.72s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.47s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.29s/it] 50%|█████     | 9/18 [00:29<00:31,  3.55s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.67s/it] 61%|██████    | 11/18 [00:31<00:14,  2.05s/it] 67%|██████▋   | 12/18 [00:31<00:09,  1.62s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.33s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.11s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.18it/s] 94%|█████████▍| 17/18 [00:34<00:00,  1.31it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.98s/it]
2024-12-08 23:49:50,421 - evaluate - INFO - test len(list(set(preds1))): 307 len(preds): 4496
2024-12-08 23:49:50,422 - evaluate - INFO - Evaluate V1: all_acc: 0.254 old_acc: 0.305 new_acc: 0.228
2024-12-08 23:49:50,429 - evaluate - INFO - Evaluate V2: all_acc: 0.215 old_acc: 0.214 new_acc: 0.216
2024-12-08 23:49:50,431 - main - INFO - Averaged stats:
2024-12-08 23:49:50,431 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.8557166655858355, 'loss_feature': 3.7559476296106973, 'loss_sep': 0.009104817659438899, 'loss_quan': 0.3340250651041667}
2024-12-08 23:49:50,432 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:50:00,201 - log_every - INFO - Epoch: [4]  [ 0/12]  eta: 0:01:57  lr: 0.000100  loss_protop: 4.9379 (4.9379)  loss_feature: 3.7271 (3.7271)  loss_sep: 0.0025 (0.0025)  loss_quan: 0.3286 (0.3286)  time: 9.7684  data: 9.4820  max mem: 3597
2024-12-08 23:50:02,627 - log_every - INFO - Epoch: [4]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8865 (4.8805)  loss_feature: 3.7289 (3.7308)  loss_sep: 0.0093 (0.0087)  loss_quan: 0.3228 (0.3242)  time: 1.0162  data: 0.8589  max mem: 3597
2024-12-08 23:50:03,088 - log_every - INFO - Epoch: [4] Total time: 0:00:12 (1.0547 s / it)
2024-12-08 23:50:03,088 - evaluate - INFO - Start validation
2024-12-08 23:50:03,089 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8865 (4.8805)  loss_feature: 3.7289 (3.7308)  loss_sep: 0.0093 (0.0087)  loss_quan: 0.3228 (0.3242)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:09, 14.65s/it] 11%|█         | 2/18 [00:15<01:47,  6.74s/it] 17%|█▋        | 3/18 [00:16<01:01,  4.09s/it] 22%|██▏       | 4/18 [00:17<00:39,  2.83s/it] 28%|██▊       | 5/18 [00:18<00:27,  2.14s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.74s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.46s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.29s/it] 50%|█████     | 9/18 [00:29<00:31,  3.53s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.65s/it] 61%|██████    | 11/18 [00:31<00:14,  2.04s/it] 67%|██████▋   | 12/18 [00:31<00:09,  1.62s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.33s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.11s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.18it/s] 94%|█████████▍| 17/18 [00:34<00:00,  1.31it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.98s/it]
2024-12-08 23:50:40,265 - evaluate - INFO - test len(list(set(preds1))): 308 len(preds): 4496
2024-12-08 23:50:40,265 - evaluate - INFO - Evaluate V1: all_acc: 0.276 old_acc: 0.342 new_acc: 0.243
2024-12-08 23:50:40,272 - evaluate - INFO - Evaluate V2: all_acc: 0.224 old_acc: 0.235 new_acc: 0.218
2024-12-08 23:50:40,274 - main - INFO - Averaged stats:
2024-12-08 23:50:40,274 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.880489985148112, 'loss_feature': 3.730803966522217, 'loss_sep': 0.008675130064754436, 'loss_quan': 0.3241984049479167}
2024-12-08 23:50:40,274 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:50:50,306 - log_every - INFO - Epoch: [5]  [ 0/12]  eta: 0:02:00  lr: 0.000100  loss_protop: 4.7084 (4.7084)  loss_feature: 3.7152 (3.7152)  loss_sep: 0.0097 (0.0097)  loss_quan: 0.3203 (0.3203)  time: 10.0312  data: 9.8521  max mem: 3597
2024-12-08 23:50:52,525 - log_every - INFO - Epoch: [5]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.7795 (4.7961)  loss_feature: 3.7141 (3.7142)  loss_sep: 0.0073 (0.0074)  loss_quan: 0.3169 (0.3174)  time: 1.0207  data: 0.8720  max mem: 3597
2024-12-08 23:50:52,989 - log_every - INFO - Epoch: [5] Total time: 0:00:12 (1.0596 s / it)
2024-12-08 23:50:52,990 - evaluate - INFO - Start validation
2024-12-08 23:50:52,990 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.7795 (4.7961)  loss_feature: 3.7141 (3.7142)  loss_sep: 0.0073 (0.0074)  loss_quan: 0.3169 (0.3174)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:14<04:09, 14.67s/it] 11%|█         | 2/18 [00:15<01:48,  6.77s/it] 17%|█▋        | 3/18 [00:16<01:01,  4.09s/it] 22%|██▏       | 4/18 [00:17<00:39,  2.83s/it] 28%|██▊       | 5/18 [00:18<00:27,  2.15s/it] 33%|███▎      | 6/18 [00:19<00:20,  1.73s/it] 39%|███▉      | 7/18 [00:20<00:16,  1.46s/it] 44%|████▍     | 8/18 [00:21<00:12,  1.29s/it] 50%|█████     | 9/18 [00:29<00:31,  3.52s/it] 56%|█████▌    | 10/18 [00:30<00:21,  2.65s/it] 61%|██████    | 11/18 [00:31<00:14,  2.04s/it] 67%|██████▋   | 12/18 [00:31<00:09,  1.62s/it] 72%|███████▏  | 13/18 [00:32<00:06,  1.33s/it] 78%|███████▊  | 14/18 [00:33<00:04,  1.12s/it] 83%|████████▎ | 15/18 [00:33<00:02,  1.04it/s] 89%|████████▉ | 16/18 [00:34<00:01,  1.17it/s] 94%|█████████▍| 17/18 [00:34<00:00,  1.31it/s]100%|██████████| 18/18 [00:35<00:00,  1.58it/s]100%|██████████| 18/18 [00:35<00:00,  1.98s/it]
2024-12-08 23:51:30,260 - evaluate - INFO - test len(list(set(preds1))): 323 len(preds): 4496
2024-12-08 23:51:30,260 - evaluate - INFO - Evaluate V1: all_acc: 0.264 old_acc: 0.341 new_acc: 0.226
2024-12-08 23:51:30,269 - evaluate - INFO - Evaluate V2: all_acc: 0.222 old_acc: 0.247 new_acc: 0.210
2024-12-08 23:51:30,270 - main - INFO - Averaged stats:
2024-12-08 23:51:30,270 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 4.796120723088582, 'loss_feature': 3.714197337627411, 'loss_sep': 0.007369791564997286, 'loss_quan': 0.3174031575520833}
2024-12-08 23:51:30,271 - train_and_evaluate - INFO - Start train one epoch
d_max: 4
2024-12-08 23:51:40,358 - log_every - INFO - Epoch: [6]  [ 0/12]  eta: 0:02:01  lr: 0.000100  loss_protop: 4.8605 (4.8605)  loss_feature: 3.6982 (3.6982)  loss_sep: 0.0090 (0.0090)  loss_quan: 0.3147 (0.3147)  time: 10.0869  data: 9.9245  max mem: 3597
2024-12-08 23:51:42,481 - log_every - INFO - Epoch: [6]  [11/12]  eta: 0:00:01  lr: 0.000100  loss_protop: 4.8196 (4.8115)  loss_feature: 3.7046 (3.7043)  loss_sep: 0.0069 (0.0073)  loss_quan: 0.3052 (0.3073)  time: 1.0174  data: 0.8762  max mem: 3597
2024-12-08 23:51:42,899 - log_every - INFO - Epoch: [6] Total time: 0:00:12 (1.0523 s / it)
2024-12-08 23:51:42,900 - evaluate - INFO - Start validation
2024-12-08 23:51:42,900 - evaluate - INFO - Radius: 2
Averaged stats: lr: 0.000100  loss_protop: 4.8196 (4.8115)  loss_feature: 3.7046 (3.7043)  loss_sep: 0.0069 (0.0073)  loss_quan: 0.3052 (0.3073)
  0%|          | 0/18 [00:00<?, ?it/s]